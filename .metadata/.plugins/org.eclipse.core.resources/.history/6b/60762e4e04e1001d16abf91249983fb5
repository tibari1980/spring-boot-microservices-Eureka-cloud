package com.arcesi.ProductService.controllers.imp;

import org.modelmapper.ModelMapper;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.http.HttpStatus;
import org.springframework.http.ResponseEntity;
import org.springframework.web.bind.annotation.CrossOrigin;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RestController;

import com.arcesi.ProductService.controllers.ApiRestCategory;
import com.arcesi.ProductService.dtos.ProductDTO;
import com.arcesi.ProductService.dtos.requests.ProductRequest;
import com.arcesi.ProductService.dtos.responses.ProductResponse;
import com.arcesi.ProductService.services.CategoryService;

import lombok.extern.slf4j.Slf4j;

@CrossOrigin(origins = "http://localhost:8086")
@RestController
@RequestMapping(value = "/api/v1/categories/")
@Slf4j
public class ApiRestCategoryController implements ApiRestCategory {

	@Autowired
	private CategoryService categoryService;
	@Autowired
	private ModelMapper modelMapper;

	@Override
	public ResponseEntity<ProductResponse> createProduct(ProductRequest productRequest, Long categoryId) {
		log.info("Inside m√©thode createProduct in Controller CategoryRestController  products: {} ,identifiant category : {}",productRequest.toString(), categoryId);
		ProductDTO productDTO=categoryService.createProduct(modelMapper.map(productRequest, ProductDTO.class),categoryId);
		return new ResponseEntity<ProductResponse>(modelMapper.map(productDTO, ProductResponse.class),HttpStatus.CREATED);
	}

}
